<div class="p-4">
  <p-card header="Weather Forecast" subheader="This component demonstrates fetching data from the server">
    
    <!-- Loading State -->
    <div *ngIf="loading" class="p-3 text-center">
      <p class="p-text-secondary">
        <i class="pi pi-spin pi-spinner mr-2"></i>
        Loading weather data...
      </p>
    </div>

    <!-- Error State -->
    <div *ngIf="error && !loading" class="p-3">
      <p-message 
        severity="warn" 
        [text]="error"
        [closable]="false">
      </p-message>
      <p class="p-text-secondary mt-2">
        <small>Showing mock data. Please check if the ASP.NET backend is running.</small>
      </p>
    </div>

    <!-- Weather Data Table -->
    <p-table 
      *ngIf="weatherData && weatherData.length > 0" 
      [value]="weatherData" 
      [tableStyle]="{'min-width': '50rem'}"
      [paginator]="true" 
      [rows]="10"
      [showCurrentPageReport]="true"
      currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
      responsiveLayout="scroll">
      
      <ng-template pTemplate="header">
        <tr>
          <th>Date</th>
          <th>Temp. (째C)</th>
          <th>Temp. (째F)</th>
          <th>Summary</th>
        </tr>
      </ng-template>
      
      <ng-template pTemplate="body" let-forecast>
        <tr>
          <td>{{ forecast.date | date:'short' }}</td>
          <td>
            <span class="p-tag p-tag-info">{{ forecast.temperatureC }}째C</span>
          </td>
          <td>
            <span class="p-tag p-tag-warning">{{ forecast.temperatureF }}째F</span>
          </td>
          <td>{{ forecast.summary }}</td>
        </tr>
      </ng-template>
    </p-table>

    <!-- No Data State -->
    <div *ngIf="(!weatherData || weatherData.length === 0) && !loading" class="p-3 text-center">
      <p class="p-text-secondary">
        <i class="pi pi-info-circle mr-2"></i>
        No weather data available
      </p>
    </div>

    <!-- Refresh Button -->
    <div class="p-3 text-center" *ngIf="!loading">
      <p-button 
        label="Refresh Data" 
        icon="pi pi-refresh" 
        (click)="loadWeatherData()"
        [loading]="loading"
        severity="secondary">
      </p-button>
    </div>

  </p-card>
</div>
